name: Daily Social Media Collection

on:
  # æ¯å¤©æ—©ä¸Š 9:00 CST (UTC 1:00)
  schedule:
    - cron: '0 1 * * *'
  # å…è¨±æ‰‹å‹•è§¸ç™¼
  workflow_dispatch:

jobs:
  trigger-collection:
    runs-on: ubuntu-latest
    
    steps:
      - name: Install Railway CLI
        run: |
          npm install -g @railway/cli
          echo "Railway CLI installed successfully"
      
      - name: Execute Collection via Railway CLI
        run: |
          echo "ğŸš€ Triggering data collection at $(date)"
          # ä½¿ç”¨ Railway CLI ç›´æ¥åŸ·è¡Œæ”¶é›†ä»»å‹™
          if [ -n "${{ secrets.RAILWAY_SERVICE_ID }}" ]; then
            # å¦‚æœæœ‰ service IDï¼Œä½¿ç”¨ç‰¹å®šæœå‹™
            railway run --token ${{ secrets.RAILWAY_TOKEN }} \
                       --service ${{ secrets.RAILWAY_SERVICE_ID }} \
                       python main.py --run-once
          else
            # å¦å‰‡åœ¨é …ç›®ç’°å¢ƒä¸­åŸ·è¡Œ
            railway run --token ${{ secrets.RAILWAY_TOKEN }} \
                       --environment ${{ secrets.RAILWAY_ENVIRONMENT_ID }} \
                       python main.py --run-once
          fi
          echo "âœ… Collection task completed at $(date)"
      
      - name: Check Collection Status
        run: |
          echo "ğŸ“Š Collection executed successfully"
          echo "Please check Railway logs and Google Sheets for results"